"../libs/sdl" library import

:randd rand 100 % 50 - 15.0 /;
:randc [] 0 3 range each {rand 128 % 128+,};


    

:mkthingy |:self| [% dup!self
 `x 0,
 `y 0,
 `dx randd,
 `dy randd,
 `col randc,
 `move (|:x,y|
     ?self?`x ?self?`dx + !x
     ?x 290 > ?x 0 < or if
         ?self?`dx neg ?self!`dx
     then
     ?self?`y ?self?`dy + !y
     ?y 290 > ?y 0 < or if
         ?self?`dy neg ?self!`dy
     then
     ?x ?self!`x
     ?y ?self!`y
 ),
 `draw (
     ?self?`col each{i} col
     ?self?`x ?self?`y 10 10 fillrect
 )
 ]
;

[] 0 1000 range each {mkthingy,} !Thingies


(
    |x:| "key down " ?x + .
    ?x 113 = if done then
) onkeydown

(
    clear
    Thingies each { i?`move@ i?`draw@ }
    flip
) ondraw

300 300 open loop close quit
